<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="ownerstyle.css"> 
    <title>SpotFinder</title>

  </head>
  <body>
    <header>
      <img src="images/AppIcon.png" width= "80" height= "80" alt="parkinglogo">

      <h1 class="text-center">SpotFinder</h1>
      <br/>

    </header>

    <main>

      <h2>Property Owner Landing Page</h2>

    <form action="driverPage.html">
      <input type="submit" value="View Parking Spaces" />
    </form>

    <h3>Submit New Spot</h3>
    <form id="driverLogin" class="form">
      <label for="spotName">Spot Name</label>
      <input type="text" name="spotName" id ="spotName">
      <br>

      <label for="picture">File Path for Photo</label>
      <input type="text" name="picture" id="picture">
      <br>

      <label for="price">Price</label>
      <input type="text" name="price" id="price">
      <br>

      <label for="availability">Availability</label>
      <input type="text" name="availability" id="availability">
      <br>

      <label for="location">Location</label>
      <input type="text" name="location" id="location">
      <br>

      <button type="submit">Submit</button>
    </form>


    <script src="js/web3.min.js"></script>
    <script src="js/truffle-contract.js"></script>
    <script src="js/app.js"></script>

    <script>

      const driverLogin = document.getElementById("driverLogin");

      driverLogin.addEventListener("submit", (e) => {
        e.preventDefault();

        var isValid = true;

        //pulls data from form
        //console.log("entered spotName is ... " + document.getElementById('spotName').value);
        var newSpotName = '"' + document.getElementById('spotName').value + '"';

        //console.log("entered picture is ... " + document.getElementById('picture').value);
        var newSpotPicture = '"' + document.getElementById('picture').value + '"';

        //console.log("entered price is ... " + document.getElementById('price').value);
        var newSpotPrice = '"' + document.getElementById('price').value + '"';

        //console.log("entered availability is ... " + document.getElementById('availability').value);
        var newSpotAvailability = '"' + document.getElementById('availability').value + '"';

        //console.log("entered location is ... " + document.getElementById('location').value);
        var newSpotLocation = '"' + document.getElementById('location').value + '"';

        if(newSpotName == '""' || newSpotPicture == '""'  || newSpotPrice == '""'  || newSpotAvailability== '""'   || newSpotLocation == '""' ) isValid = false;

        if (isValid){
          $.getJSON('../spots.json', function(data) {
            var newIndex = data.length;

            const asJSON = JSON.parse('{"id": '+ newIndex + ', "name":' + newSpotName + ',"picture": '+ newSpotPicture + ',"price": ' + newSpotPrice + ',"availability": ' + newSpotAvailability + ',"location": ' + newSpotLocation + '}');

            //console.log(asJSON);

            data.push(asJSON);


            console.log(data);
          });
        } else {
          alert("Please double check data is entered in all fields in order to submit a new parking space.");
        }


        console.log("form submitted");
      });
    </script>

      </main>
    </div><!--End Wrapper-->

    <footer>
    <p> <small><i>Copyright &copy; 2021 SpotFinder.Inc</i></small>

      <small><i>SpotFinder@g.cofc.edu</i></small>
      
      <small><i>Contact Info:(xxx)xxx-xxxx</i></small></p> 
  </footer>

  </body>
</html>
